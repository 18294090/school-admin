{% extends "base.html" %}
{% from 'bootstrap/form.html' import render_field %}
{%block title%}
<TITLE>作业</TITLE>
<style>
    .dropdown-menu li {
    position: relative;
    }
    .dropdown-menu .dropdown-submenu {
    display: none;
    position: absolute;
    left: 100%;
    top: -7px;
    }
    .dropdown-menu .dropdown-submenu-left {
    right: 100%;
    left: auto;
    }
    .dropdown-menu > li:hover > .dropdown-submenu {
    display: block;
    }
</style>
{%endblock%}
{% block main%}

<div class="container-fluid">
<br>
	<div class="row">
		<div class="col-md-4">
			<div class="card shadow " style="height: 180px">
                <div class="card-block">
					<h5 class="card-title">
						发布作业                       
                    </h5>
                    <div class="row">
                        <!--一张图片，来自于static文件夹下的OIG.jpeg,图片大小为自适应-->
                        <div class="col-3">
                            <img src="{{url_for('static',filename='/picture/OIG.jpeg')}}" class="img-fluid  " alt="Responsive image" style="height: 90px;">
                        </div>    
                        <p class="card-text col-9">
                            1、发布作业，填写作业标题等作业信息<br>
                            2、确定选择题答案<br>
                            3、生成打印相应答题卡<br>
                        </p>
                    </div>    
				</div>
                <div class="card-block">
                    <button type="button" onclick="document.location = '/job/genarate_paper'" class="btn btn btn-primary">发布</button></a>
                </div>
			</div>
        </div>
        <div class="col-md-4">
            <div class="card shadow" style="height: 180px">                
                <div class="card-block">
                    <h5 class="card-title">
                        作业分析                               
                    </h5>
                    <div class="row">                   
                        <div class="col-3">
                            <img src="{{url_for('static',filename='/picture/line.jpeg')}}" class="img-fluid" alt="Responsive image" style="height: 90px;">
                        </div>    
                        <p class="card-text col-9">
                        1、年级报表<br>
                        2、班级作业统计<br>
                        3、学生个人分析报告<br>    
                        </p>
                    </div>
                </div>
                <div class="card-block">
                    <a class="btn btn-primary" href="/job/job_analyse">前往</a>
                </div>
            </div>
        </div>
        <div class="col-md-4" >
            <div class="card shadow" style="height: 180px">
                <div class="card-block">
                    <h5 class="card-title">
                        补交作业
                    </h5>
                    <div class="row">
                        <!--一张图片，来自于static文件夹下的submit.jpeg,图片大小为自适应-->
                        <div class="col-3">
                            <img src="{{url_for('static',filename='/picture/submit.jpeg')}}" class="img-fluid" alt="Responsive image" style="height: 90px;">
                        </div>    
                        <div class="card-text col-9">
                            <p>
                            上传答卷，不需要区分作业
                            </p>
                            <div class=" d-flex input-group">
                                <input type="file" class="form-control" id="GroupFile" aria-describedby="GroupFileAddon" aria-label="Upload" multiple accept=".png,.jpg,.bmp">
                                <button class="btn btn-outline-primary" type="button" id="GroupFileAddon" onclick="upload_paper1()">上传</button>
                            </div>  
                        </div>
                    </div>
                </div>                
                <div class="card-block">
                    <a class="btn btn-primary"onclick="judge1()"><i class="fa fa-bicycle"></i>阅卷</a>
                </div>                    
                <br>
            </div>
        </div>
	</div>

<br>

{% with messages = get_flashed_messages() %}
    {% if messages %}
          {% for message in messages %}
        <div class="alert alert-dismissable alert-danger" id="message">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">
                ×
            </button>
            <h4>
                警告
            </h4> <strong>作业已过截止日期不能提交</strong> 
		</div>
          {% endfor %}
    {% endif %}
 {% endwith %}
<div class="row">
    <div class="col-12">    
        <div class=" d-flex input-group  shadow" role="search">
            <input class="form-control me-2" type="search" id="search" placeholder="请输入要查找的作业名称" aria-label="Search">
            <button class="btn btn-primary" onclick="search_job()">查找作业</button>
        </div>
    </div>
</div>
<br>
<div class="row">
<div class="col-4"></div>
<div class="col-4"> 
<div class="d-flex align-items-center d-none" id="spinners" >
<strong>正在阅卷，请稍后...</strong>
<div class="spinner-grow spinner-grow-sm ms-auto  text-secondary" role="status" aria-hidden="true"></div>
<div class="spinner-grow spinner-grow-sm ms-auto  text-primary" role="status" aria-hidden="true"></div>
<div class="spinner-grow spinner-grow-sm ms-auto  text-success" role="status" aria-hidden="true"></div>
<div class="spinner-grow spinner-grow-sm ms-auto  text-info" role="status" aria-hidden="true"></div>
<div class="spinner-grow spinner-grow-sm ms-auto  text-light" role="status" aria-hidden="true"></div>
</div>
</div>
<div class="col-4"></div>
</div>
<div class="col-md-12">
        <table class="table  table-striped shadow " style="text-align:center">
            <thead class="table-primary">
                <tr>
                    <th>
                        序号
                    </th>
                    <th>
                        作业名称
                    </th>
                    <th>
                        学科
                    </th>                    
                    <th>
                        发布时间
                    </th>
                    <th>
                        发布者
                    </th>
                    
                    <th>
                        上传答卷
                    </th>
                    <th>
                        待阅卷
                    </th>
                    <th>
                        已阅卷
                    </th>
                    <th>
                        操作
                    </th>
                </tr>
            </thead>
            <tbody>
                {%for i in jobs%}
                <tr style='vertical-align: middle;'>
                    <td>{{loop.index + pagination.skip }}</td>
                    <td><a href='/job/job_info/{{i.id}}'>{{i.job_name}}</a></td>
                    <td>{{i.subject}}</td>                        
                    <td>{{i.publish_time}}</td>                    
                    <td>{{i.user.realname}}</td>                    
                    <td> <div class="input-group">
                        <input type="file" class="form-control" id="inputGroupFile{{i.id}}" aria-describedby="inputGroupFileAddon04" aria-label="Upload" multiple accept=".png,.jpg,.bmp">
                        <button class="btn btn-outline-primary" type="button" id="inputGroupFileAddon04" onclick="upload_paper({{i.id}})">上传</button>
                        </div>
                    </td>
                    <td id="c-{{i.id}}">{{count[i.id]}}</td>
                    <td id="r-{{i.id}}">{{count1[i.id]}}</td>	
                    <td>
                        <div class="btn-group btn-group-sm" role="group" aria-label="Basic example"> 
                            <button type="button" class="btn btn-primary dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                操作
                            </button> 
                            <ul class="dropdown-menu">
                                <li><button type="button" class="btn btn-secondary text-nowrap dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal" onclick="get_class({{i.id}})">分配作业</button></li>
                                <li><button type="button" class="btn btn-secondary text-nowrap dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal1" onclick="get_answer({{i.id}})">选择题答案</button></li>
                                <li><button type="button" class="btn btn-secondary text-nowrap dropdown-item" onclick="window.location.href='{{ url_for('static', filename='job/answerCard/'+"/"+i.paper_url) }}'">查看答题卡</button></li>
                                <li><button type="button" class="btn btn-secondary text-nowrap dropdown-item" onclick="window.location.href='/job/show_paper/{{i.question_paper}}'">查看试题卷</button></li>
                                <li><button type="button" class="btn btn-secondary text-nowrap dropdown-item"  onclick=judge({{i.id}}) >选择题阅卷</button>
                                </li>
                                {%if i.no_multiple_choice_infor|length>2%} 
                                <li>   
                                                                                  
                                <button type="button" class="btn btn-secondary text-nowrap dropdown-item" data-bs-toggle="modal" data-bs-target="#exampleModal2" onclick="get_title_number({{i.id}})">填空题阅卷</button>
                                </li>
                                {%endif%}
                                <li>
                                <button type="button" class="btn btn-secondary text-nowrap dropdown-item"  onclick="window.location.href='/job/judge_report/{{i.id}}'">查看阅卷报告</button>
                                </li>
                                {%if count1[i.id]==0 and count[i.id]==0%}
                                <li>
                                <button type="button" class="btn btn-secondary dropdown-item" id="cancel-{{i.id}}" name="{{i.paper_url}}">删除</button>
                                </li>
                                {%endif%}
                            </ul>
                        </div>  
                    </td>
                </tr>
                {%endfor%}
            </tbody>
        </table>
    {{ pagination.links }}
</div>
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">选择要分配该作业的班级</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="job_class">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick=assign_job()>确定</button>
      </div>
    </div>
  </div>
</div>
<!-- Modal1 -->
<div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel1">选择题答案</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" ></button>
      </div>
      <div class="modal-body" id='show_answer'>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" >确定</button>        
    </div>
    </div>
  </div>
</div>
</div>
       
<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="complete" aria-hidden="true">
  <div class="modal-dialog modal-lg" >
    <div class="modal-content">
      <div class="modal-header">  
        <div class="row">            
            <div class="col-sm-9">
             <div class="modal-title fs-5"  id="complete" ></div>
            </div>
            <div class="col-sm-3">
            <input type="text" class="form-control" id="search_stu" placeholder="请输入学生姓名" aria-label="Search">
            </div>
        </div> 
      </div>
      <div class="modal-body" id='c-judge'>
            <div ></div>
            <div id="txt"></div> 
            <div id="image" ></div> 
      </div>
      <div class="modal-footer">      
      <label>评分</label>
      <div class="btn-group btn-group" role="group" id='btn-group'>
      </div>        
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="UpdateClassInfo">关闭</button>
      </div>
    </div>
  </div>
</div>

</div>
<script  src="/static/build/js/jquery.min.js"></script>
<script>
    function update_class_info(id){
        var csrf_token="{{csrf_token()}}";
        var data={"id":id};
        $.ajax({
                url: "/job/UpdateClassInfo/",    // 提交到controller的url路径 
                headers:{"X-CSRFToken":csrf_token},             //提交给flask后台必须有csrf认证
                type: "POST",    // 提交方式
                contentType: 'application/json; charset=UTF-8', //提交数据类型
                data: JSON.stringify(data),  // data为String类型，必须为 Key/Value 格式。
                dataType: "json",    // 服务器端返回的数据类型
                success: function (data) {    // 请求成功后的回调函数，其中的参数data为controller返回的map,也就是说,@ResponseBody将返回的map转化为JSON格式的数据，然后通过data这个参数取JSON数据中的值    
                   alert(data)
                },
                error:function (error) {                 
                alert("成绩更新失败，请练习管理员");},
            });
    }
    function get_answer(id){
        $("#show_answer").empty();
        $.ajax({
                url: "/job/show_answer/"+String(id),// 提交到controller的url路径 
                             //提交给flask后台必须有csrf认证
                type: "GET", 
                dataType: "json",    // 服务器端返回的数据类型
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                success: function(data) {
                    data=JSON.parse(data)
                // 遍历字典的每个键值对
                $.each(data, function(key, value) {
                    //显示答案
                    $("#show_answer").append("<p>"+key+"、"+value+"</p>");
                    ;
                });
                }
    })
    }
    function search_job(){
        var id=$("#search").val();
        console.log(id)
        if (id)
           { window.location.href="/job/search_job/"+String(id);}
        else{
            window.location.href="/job/search_job/"+"all";
        }
    }
    function assign_job(){
        var id=$("#job_class").attr("name");
        var values = [];
        var markedCheckbox = document.getElementsByName("checks");
        for (var checkbox of markedCheckbox) {
        if (checkbox.checked) {
            values.push([checkbox.value,true]);
        }
        else{
            values.push([checkbox.value,false]);
        }
        }
        $.ajax({
                url: "/job/assign_job/"+String(id),    // 提交到controller的url路径 
                             //提交给flask后台必须有csrf认证
                type: "POST",                   
                data: {
                    list:JSON.stringify(values),
                    csrf_token : '{{csrf_token()}}'
                },
                dataType: "json",// 服务器端返回的数据类型
                success: function(data) {
                    alert(data)
                },
                error:function(erro){
                    alert(erro)
                }
                }
                )
    }
   function get_class(id){    
     $.ajax({
                url: "/job/assign_job/"+String(id),    // 提交到controller的url路径 
                             //提交给flask后台必须有csrf认证
                type: "GET", 
                dataType: "json",    // 服务器端返回的数据类型
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                 success: function(data) {
                $("#job_class").empty();
                $("#job_class").attr("name", id);    
                // 遍历字典的每个键值对
                $.each(data[0], function(key, value) {
                // 分割键字符串，得到id和name
                var id = key.split("-")[0];
                var name = key.split("-")[1];
                // 创建一个新的div元素，添加form-check类
                var div = $("<div class='form-check form-check-inline'></div>");
                // 创建一个新的check元素，添加form-check-input类
                var check = $("<input class='form-check-input' type='checkbox' name='checks' value='" + id + "' id='" + key + "'>");
                // 根据值设置check的选中状态
                if (value) {
                    check.prop("checked", true);
                }
                // 创建一个新的label元素，添加form-check-label类，并设置for属性为id
                var label = $("<label class='form-check-label' for='" + id + "'>" + name + "</label>");
                // 将check和label添加到div中
                div.append(check);
                div.append(label);
                // 将div添加到网页的某个容器中，比如id为container的div
                $("#job_class").append(div);
                });
                }
     });
            }
            

    function anti(){
        var stu=document.getElementsByName("stu");
        for(var i=0;i<stu.length;i++){
            stu[i].checked=!stu[i].checked;
        }
        };

    function cls(){
        var stu=document.getElementsByName("stu");
        for(var i=0;i<stu.length;i++){
            stu[i].checked=false;
        };
        };
    function upload_paper(id){
        var file=document.getElementById("inputGroupFile"+String(id));
        var formData =new FormData();
        var files = file.files;
        for(var i=0; i<files.length; i++){
            formData.append('files',files[i]);
        }
        var csrf_token="{{csrf_token()}}";
        $.ajax({
                url: "/job/upload/"+String(id),    // 提交到controller的url路径 
                headers:{"X-CSRFToken":csrf_token},             //提交给flask后台必须有csrf认证
                type: "POST",    // 提交方式               
                data: formData,  // data为String类型，必须为 Key/Value 格式。
                dataType: "json",    // 服务器端返回的数据类型
                cache: false,//上传文件无需缓存
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                success: function (data) {    // 请求成功后的回调函数，其中的参数data为controller返回的map,也就是说,@ResponseBody将返回的map转化为JSON格式的数据，然后通过data这个参数取JSON数据中的值
                    if (data) {
                       alert(data[0]+"个文件上传成功")
                       file.value=""
                       var counttag=document.getElementById("c-"+String(id))
                       counttag.innerHTML=""
                       counttag.innerHTML="<a href="+{{'/answer/url'|replace('url',id)}}+">"+data[1]+"</a>"
                        judge(id)
                    } else {
                        console.log(data)
                        alert("上传失败")
                    }
                },
            });
    };
    function upload_paper1(){
        var file=document.getElementById("GroupFile");
        var formData =new FormData();
        var files = file.files;
        for(var i=0; i<files.length; i++){
            formData.append('files',files[i]);
        }
        var csrf_token="{{csrf_token()}}";
        $.ajax({
                url: "/job/upload/all",// 提交到controller的url路径 
                headers:{"X-CSRFToken":csrf_token}, //提交给flask后台必须有csrf认证
                type: "POST",    // 提交方式               
                data: formData,  // data为String类型，必须为 Key/Value 格式。
                dataType: "json",    // 服务器端返回的数据类型
                cache: false,//上传文件无需缓存
                processData: false,//用于对data参数进行序列化处理 这里必须false
                contentType: false, //必须
                success: function (data) {    // 请求成功后的回调函数，其中的参数data为controller返回的map,也就是说,@ResponseBody将返回的map转化为JSON格式的数据，然后通过data这个参数取JSON数据中的值
                    if (data) {
                       alert(data[0]+"个文件上传成功")
                       file.value=""
                       var counttag=document.getElementById("c-"+String(id))
                       counttag.innerHTML=""
                       counttag.innerHTML="<a href="+{{'/answer/url'|replace('url',id)}}+">"+data[1]+"</a>"
                        judge(id)
                    } else {
                        console.log(data)
                        alert("上传失败")
                    }
                },
            });
    };
    function set_mark(id,m){
        //获取单选框的值
        var title_number=$("input[name='cpl_number']:checked").val();        
        data={"id":id,"title_number":title_number,"mark":m}
        var csrf_token="{{csrf_token()}}";
        console.log(data)
        $.ajax({
                url: "/job/set_cpl_mark/",    // 提交到controller的url路径 
                headers:{"X-CSRFToken":csrf_token},             //提交给flask后台必须有csrf认证
                type: "POST",    // 提交方式
                contentType: 'application/json; charset=UTF-8', //提交数据类型
                data: JSON.stringify(data),  // data为String类型，必须为 Key/Value 格式。
                dataType: "json",    // 服务器端返回的数据类型
                success: function (data) {    // 请求成功后的回调函数，其中的参数data为controller返回的map,也就是说,@ResponseBody将返回的map转化为JSON格式的数据，然后通过data这个参数取JSON数据中的值    
                    c_judge(data,title_number)
                },
                error:function (error) {
                console.log("cuowu")  
                alert(error);}
            });
    } 
    function c_judge(id,m){       
        var csrf_token="{{csrf_token()}}"; 
        //获取search_stu的值
        var stu=$("#search_stu").val();
        $("#txt").empty(); 
        $("#image").empty();       
        $.ajax({
                url: "/job/cpl_judge/",    // 提交到controller的url路径 
                headers:{"X-CSRFToken":csrf_token},             //提交给flask后台必须有csrf认证
                type: "POST",    // 提交方式                
                data: {'id':id,
                        'stu':stu,
                        'title_number':m},  // data为String类型，必须为 Key/Value 格式。                
                success: function (response, status, xhr) { 
                    var contentType = xhr.getResponseHeader("Content-Type"); 
                    handleResponse(response, contentType); },
                     error: function(xhr, status, error) { console.log("Error: " + error); }     
            });
    };
    function handleResponse(response, contentType) {
            if (contentType.includes("text/plain")) {
                
                $("#txt").text(response); 
                } 
            else if (contentType.includes("application/json")) {
                    $("#txt").text("作者:"+response.name+" 题号："+response.No+" 总分："+response.mark);
                    var img = $("<img>").attr("src", "data:image/png;base64," + response.image);
                    img.attr("class","img-fluid") 
                    img.attr("alt","Image")
                    
                    $("#image").html(img);
                    $("#btn-group").empty();
                    for(var i=0;i<Number(response.mark)+1;i++){
                    var btn=$("<button>").text(i);
                    btn.attr("class",'btn btn-primary')
                    btn.attr("onclick","set_mark("+response.id+","+String(i)+")")
                    $("#btn-group").append(btn);
                    }
                } 
            else {
                alert("Unknown content type: " + contentType); } 
            }
    function get_title_number(id){
        //给UpdateClassInfo按钮添加一个onclick="update_class_info(id)"属性
        $("#UpdateClassInfo").attr("onclick","update_class_info("+id+")");
        var csrf_token="{{csrf_token()}}";
        $.ajax({
                url: "/job/get_cpl_title_number/",    // 提交到controller的url路径 
                headers:{"X-CSRFToken":csrf_token},             //提交给flask后台必须有csrf认证
                type: "POST",    // 提交方式                
                data: {'id':id},  // data为String类型，必须为 Key/Value 格式。                
                success: function (data) { 
                    title_number=data
                    $("#txt").empty(); 
                    $("#image").empty();  
                     $("#complete").empty();
                     $("#complete").append("选择题目：");
                    for(var i=0;i<title_number.length;i++){
                        var nod=`<div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="cpl_number" id="cpl${title_number[i]}" value="${title_number[i]}" onclick="c_judge(${id},${title_number[i]})">
                            <label class="form-check-label" for="cpl${title_number[i]}">${title_number[i]}</label>
                            </div>`
                        $("#complete").append(nod);
                    }
                    },
                error: function(xhr, status, error) { console.log("Error: " + error); }     
            });
    };

    
 $("[id^='cancel']").click(function(e) {  
    var url ="/job/del/";
    var result = window.confirm("警告：删除该作业将删除所有上传的答题卡，以及有关该作业的所有信息，确定吗？");
    if(result){
        var button = $(e.target);
  // 获取按钮的name属性
    var url1 = button.attr("name");
    var sendData = {        
        'flag':0,
        'url':url1,
        'csrf_token':'{{ csrf_token() }}'
    };
     $.ajax({
            url:url,
            type:'post',
            data:sendData,
            success:function (data) {                                 
                  alert(data)
                  location.reload()               
                } ,
            error:function (error) {
                alert(error);
            },
        });
    }
})
 function judge(id){
        var data={"judge":id};
        var csrf_token="{{csrf_token()}}";
        showSpinners();  // 显示 Spinners
        $.ajax({
                url: "/job/judge/"+String(id),    // 提交到controller的url路径 
                headers:{"X-CSRFToken":csrf_token},             //提交给flask后台必须有csrf认证
                type: "POST",    // 提交方式
                contentType: 'application/json; charset=UTF-8', //提交数据类型
                data: JSON.stringify(data),  // data为String类型，必须为 Key/Value 格式。
                dataType: "json",    // 服务器端返回的数据类型
                success: function (data) {    // 请求成功后的回调函数，其中的参数data为controller返回的map,也就是说,@ResponseBody将返回的map转化为JSON格式的数据，然后通过data这个参数取JSON数据中的值
                    hideSpinners();  // 隐藏 Spinners                                          
                    window.location.href="/job/judge_report/"+String(id);
                },
                error:function (error) {
                        hideSpinners();
                        console.log(error);
                        //显示 erro的responseText内容
                    alert(error.responseText);}
            });
    };
    function judge1(){       
        var csrf_token="{{csrf_token()}}";
         // 显示 Spinners
         showSpinners(); 
        $.ajax({
                url: "/job/super_judge/",    // 提交到controller的url路径 
                headers:{"X-CSRFToken":csrf_token},//提交给flask后台必须有csrf认证
                type: "POST",// 提交方式
                contentType: 'application/json; charset=UTF-8', //提交数据类型
                data: "",  // data为String类型，必须为 Key/Value 格式。
                dataType: "json",    // 服务器端返回的数据类型
                success: function (data) {    // 请求成功后的回调函数，其中的参数data为controller返回的map,也就是说,@ResponseBody将返回的map转化为JSON格式的数据，然后通过data这个参数取JSON数据中的值
                    hideSpinners();  // 隐藏 Spinners                                          
                    alert(data)
                    
                  
                },
                error:function (error) {
                    hideSpinners();
                    console.log(error)
                    alert("选择题阅卷失败，请检查答题卡或联系管理员");
                }
            });
    };
    function showSpinners() {
    $("#spinners").removeClass('d-none');
    //使spinners全屏局中
    $("#spinners").css("position", "fixed");
    $("#spinners").css("top", "50%");
    $("#spinners").css("left", "50%");
    $("#spinners").css("transform", "translate(-50%, -50%)");
    //将spinners置于最上层
    $("#spinners").css("z-index", "9999");
    //使网页变为灰色，不可点击，不可滚动
    $("body").css("pointer-events", "none");
    }
    // 隐藏 Spinners
    function hideSpinners() {
    $("#spinners").addClass('d-none');
    //使网页恢复点击和滚动
    $("body").css("pointer-events", "auto");
    }
</script>      
{%endblock%}



